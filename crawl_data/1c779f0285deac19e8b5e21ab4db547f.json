{"url": "http://www.ics.uci.edu/~eppstein/161/960208.html", "word_count": 1986, "words": ["Shortest", "paths", "and", "topological", "ordering", "ICS", "161:", "Design", "and", "Analysis", "of", "Algorithms", "Lecture", "notes", "for", "February", "8,", "1996", "Shortest", "Paths", "The", "basic", "problem:", "Find", "the", "\"best\"", "way", "of", "getting", "from", "s", "to", "t", "where", "s", "and", "t", "are", "vertices", "in", "a", "graph.", "We", "measure", "\"best\"", "simply", "as", "the", "sum", "of", "edge", "lengths", "of", "a", "path.", "For", "instance", "the", "graph", "could", "be", "a", "map", "representing", "intersections", "as", "vertices,", "road", "segments", "as", "edges;", "you", "want", "to", "find", "either", "the", "shortest", "or", "fastest", "route", "from", "your", "house", "to", "ICS.", "Although", "both", "of", "these", "problems", "have", "different", "solutions,", "they", "are", "both", "shortest", "path", "problems;", "in", "one", "the", "length", "of", "an", "edge", "represents", "the", "actual", "mileage", "of", "a", "segment", "of", "road,", "while", "in", "the", "other", "it", "represents", "the", "time", "it", "would", "take", "to", "drive", "it,", "but", "in", "both", "cases", "the", "important", "fact", "is", "that", "the", "total", "length", "of", "a", "path", "is", "measured", "by", "adding", "the", "lengths", "of", "individual", "edges.", "For", "another", "example,", "which", "I", "mentioned", "in", "my", "first", "lecture", "on", "graph", "algorithms,", "the", "graph", "might", "have", "vertices", "representing", "airports,", "with", "edges", "representing", "possible", "flights,", "and", "the", "\"length\"", "of", "an", "edge", "measuring", "the", "cost", "of", "taking", "that", "flight;", "your", "problem", "would", "then", "be", "to", "find", "the", "cheapest", "flight", "from", "e.g.", "SNA", "to", "JFK.", "Note", "that", "these", "graphs", "may", "be", "directed;", "e.g.", "there", "may", "be", "a", "one-way", "road,", "or", "flights", "in", "one", "direction", "might", "have", "different", "costs", "than", "those", "the", "other", "way.", "We", "are", "going", "to", "make", "a", "big", "assumption:", "that", "all", "the", "edges", "have", "lengths", "that", "are", "positive", "numbers.", "This", "is", "often", "but", "not", "always", "the", "case;", "it", "makes", "sense", "in", "the", "examples", "above,", "but", "it", "is", "conceivable", "that", "an", "airline", "could", "pay", "people", "to", "take", "certain", "routes,", "so", "that", "the", "lengths", "of", "those", "edges", "in", "the", "airport", "graph", "might", "be", "negative.", "We'll", "pretend", "this", "never", "happens.", "It", "makes", "the", "algorithms", "a", "lot", "easier.", "Later", "we'll", "see", "some", "special", "cases", "where", "we", "can", "handle", "negative", "weights.", "Rather", "than", "computing", "one", "distance", "d(s,t),", "we'll", "compute", "d(s,x)", "for", "all", "vertices", "x.", "This", "is", "known", "as", "the", "single", "source", "shortest", "path", "problem", "(s", "is", "the", "source", ").", "It", "turns", "out", "that", "computing", "this", "extra", "information", "makes", "things", "easier,", "because", "then", "we", "can", "put", "together", "information", "about", "paths", "with", "fewer", "edges", "to", "get", "paths", "with", "more", "edges.", "Paths", "from", "distances", "Suppose", "we", "already", "know", "the", "distances", "d(s,x)", "from", "s", "to", "every", "other", "vertices.", "This", "isn't", "a", "solution", "to", "the", "shortest", "path", "problem,", "because", "we", "want", "to", "know", "actual", "paths", "having", "those", "distances.", "How", "can", "we", "find", "those", "paths?", "That", "there", "are", "two", "kinds", "of", "shortest", "paths:", "those", "formed", "by", "a", "single", "edge", "(s,t),", "and", "those", "in", "which", "the", "path", "from", "s", "to", "t", "goes", "through", "some", "other", "vertices;", "let's", "say", "x", "is", "the", "last", "vertex", "the", "path", "goes", "through", "before", "t.", "Then", "in", "the", "second", "case,", "the", "overall", "path", "must", "be", "formed", "by", "concatenating", "a", "path", "from", "s", "to", "x", "with", "edge", "(x,t).", "(We", "can", "view", "both", "types", "of", "shortest", "path", "as", "being", "similar", "if", "we", "think", "of", "the", "shortest", "path", "from", "s", "to", "s", "as", "being", "one", "with", "no", "edges", "in", "it.)", "Further,", "the", "path", "from", "s", "to", "x", "must", "itself", "be", "a", "shortest", "path", "(since", "otherwise", "concatenating", "the", "shortest", "path", "with", "(x,t)", "would", "decrease", "the", "length", "of", "the", "overall", "path).", "A", "final", "observation", "is", "that", "d(s,x)", "must", "be", "less", "than", "d(s,t),", "since", "d(s,x)=d(s,t)+length(x,t)", "and", "we", "are", "assuming", "all", "edges", "have", "positive", "length.", "Therefore", "if", "we", "only", "know", "the", "correct", "value", "of", "x", "we", "can", "find", "a", "shortest", "path:", "Algorithm", "1:", "for", "each", "vertex", "y", "in", "sorted", "order", "by", "d(s,y)", "let", "(x,y)", "be", "an", "edge", "with", "d(s,x)+length(x,y)=d(s,y)", "path(s,y)", "=", "path(s,x)", "+", "edge", "(x,y)", "We", "will", "want", "to", "use", "something", "like", "this", "idea", "to", "compute", "shortest", "paths", "without", "already", "knowing", "their", "lengths.", "When", "we", "get", "to", "y", "in", "the", "loop,", "it", "will", "still", "be", "ok", "to", "use", "terms", "like", "d(s,x)", "if", "this", "is", "less", "than", "d(s,y),", "because", "we", "will", "have", "already", "processed", "x", "in", "a", "previous", "iteration.", "But", "the", "pseudo-code", "above", "uses", "d(s,y)", "itself", "twice,", "and", "this", "will", "not", "work", "as", "well.", "To", "get", "rid", "of", "the", "second", "use", "of", "d(s,y),", "in", "which", "we", "test", "to", "determine", "which", "edge", "to", "use,", "we", "can", "notice", "that", "(because", "we", "are", "computing", "a", "shortest", "path)", "d(s,x)+length(x,y)", "will", "be", "less", "than", "any", "similar", "expression,", "so", "instead", "of", "testing", "it", "for", "equality", "with", "d(s,y)", "we", "can", "just", "find", "a", "minimum:", "Algorithm", "2:", "for", "each", "vertex", "y", "in", "sorted", "order", "by", "d(s,y)", "let", "(x,y)", "be", "an", "edge", "with", "x", "already", "processed,", "minimizing", "d(s,x)+length(x,y)", "path(s,y)", "=", "path(s,x)", "+", "edge", "(x,y)", "d(s,y)", "=", "d(s,x)", "+", "length(x,y)", "Dijkstra's", "algorithm", "The", "only", "remaining", "use", "of", "d(s,y)", "in", "this", "algorithm", "is", "to", "determine", "what", "order", "to", "process", "the", "vertices", "in.", "Dijkstra", "'s", "algorithm", "for", "shortest", "paths", "does", "this", "almost", "exactly", "like", "Prim's", "algorithm", ".", "Remember", "that", "in", "Prim's", "algorithm,", "we", "add", "vertices", "and", "edges", "one", "a", "a", "time", "to", "a", "tree,", "at", "each", "step", "choosing", "the", "shortest", "possible", "edge", "to", "add.", "Dijkstra's", "algorithm", "does", "the", "same", "thing,", "only", "choosing", "the", "edge", "to", "add", "at", "each", "step", "to", "be", "the", "one", "minimizing", "d(s,x)+length(x,y).", "Algorithm", "3:", "(Dijkstra,", "basic", "outline)", "let", "T", "be", "a", "single", "vertex", "s", "while", "(T", "has", "fewer", "than", "n", "vertices)", "{", "find", "edge", "(x,y)", "with", "x", "in", "T", "and", "y", "not", "in", "T", "minimizing", "d(s,x)+length(x,y)", "add", "(x,y)", "to", "T", "d(s,y)=d(s,x)+length(x,y)", "}", "The", "actual", "shortest", "paths", "can", "be", "found", "by", "following", "the", "path", "in", "T", "from", "s", "to", "t.", "This", "defines", "a", "structure", "known", "as", "a", "\"shortest", "path", "tree\".", "In", "practice", "it", "may", "sometimes", "faster", "to", "build", "two", "trees,", "one", "from", "s", "and", "one", "from", "t,", "and", "stop", "when", "they", "run", "into", "each", "other", "(this", "usually", "ends", "up", "visiting", "less", "of", "the", "graph).", "Just", "like", "with", "Prim's", "algorithm,", "we", "can", "use", "heaps", "to", "perform", "the", "hard", "part", "of", "each", "iteration", "(finding", "the", "best", "edge)", "in", "logarithmic", "time.", "Algorithm", "4:", "(Dijkstra", "with", "heaps)", "make", "a", "heap", "of", "values", "(vertex,edge,distance)", "initially", "(v,-,infinity)", "for", "each", "vertex", "let", "tree", "T", "be", "empty", "while", "(T", "has", "fewer", "than", "n", "vertices)", "{", "let", "(v,e,d(v))", "have", "the", "smallest"], "content_hash": "d72a858b36869fdb892d7d9b185ea107"}