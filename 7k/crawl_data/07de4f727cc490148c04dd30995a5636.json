{"url": "https://grape.ics.uci.edu/wiki/asterix/attachment/wiki/stats170ab-2018/hw7_template_import_tables_from_json.py", "word_count": 493, "words": ["hw7_template_import_table", "_from_j", "on.py", "on", "tat", "170ab-2018", "\u2013", "Attachment", "\u2013", "ASTERIX", "Login", "Preference", "About", "Trac", "Regi", "ter", "Context", "Navigation", "Back", "to", "tat", "170ab-2018", "tat", "170ab-2018", ":", "hw7_template_import_table", "_from_j", "on.py", "File", "hw7_template_import_table", "_from_j", "on.py,", "1.8", "KB", "(added", "by", "Padhraic", "Smyth", ",", "8", "year", "ago", ")", "Python", "cript", "template", "for", "Homework", "7", "Line", "1", "#", "Template", "for", "Homework", "7", "2", "#", "3", "#", "FOR", "170A", "Student", ":", "4", "#", "Replace", "***", "with", "appropriate", "Python", "code", "and", "value", ",", "and", "al", "o", "extend", "the", "code", "to", "read", "in", "information", "from", "the", "5", "#", "JSON", "file", "with", "review", "data", "6", "#", "7", "#", "Import", "Yelp", "information", "from", "JSON", "file", "and", "put", "into", "a", "Po", "tgre", "databa", "e", "8", "#", "Code", "for", "Stat", "170A,", "Winter", "2018", "9", "#", "10", "#", "For", "documentation", "on", "Yelp", "JSON", "file", "ee:", "11", "#", "http", "://www.yelp.com/data", "et/documentation/j", "on", "12", "#", "13", "#", "Code", "adapted", "from:", "http", "://manoj", "aha.com/2017/03/07/", "etting-po", "tgre", "ql-python-ubuntu-yelp-data", "et-challenge/", "14", "#", "Author:", "Manoj", "Pravakar", "Saha", "15", "#", "Thi", "work", "i", "licen", "ed", "under", "the", "Creative", "Common", "Attribution-NonCommercial-ShareAlike", "4.0", "International", "Licen", "e.", "16", "17", "#", "Import", "P", "ycopg", "Po", "tgre", "adapter", "for", "Python", "18", "import", "p", "ycopg2", "19", "20", "#", "Import", "Python'", "default", "JSON", "encoder", "and", "decoder", "21", "import", "j", "on", "22", "23", "#", "Open", "a", "connection", "to", "the", "databa", "e", "24", "try", ":", "25", "db_conn", "=", "p", "ycopg2", ".", "connect", "(", "\"dbname='yelp'", "ho", "t='localho", "t'", "u", "er='****'", "pa", "word='****'\"", ")", "26", "print", "(", "\"Connected", "to", "the", "yelp", "databa", "e...\"", ")", "27", "except", ":", "28", "print", "(", "\"Unable", "to", "connect", "to", "the", "databa", "e\"", ")", "29", "30", "#", "Initialize", "an", "empty", "li", "t", "for", "temporarily", "holding", "a", "JSON", "object", "31", "data", "=", "[]", "32", "MAXLINES", "=", "****", "#", "option", "to", "import", "only", "up", "to", "MAXLINES", "rather", "than", "the", "whole", "file", "33", "34", "#", "Open", "a", "JSON", "file", "from", "the", "data", "et", "and", "read", "data", "line-by-line", "35", "with", "open", "(", "'yelp_j", "on/bu", "ine", ".j", "on'", ")", "a", "fileobject", ":", "36", "ctr", "=", "1", "37", "for", "line", "in", "fileobject", ":", "38", "if", "ctr", "<=", "MAXLINES", ":", "39", "data", "=", "j", "on", ".", "load", "(", "line", ")", "40", "41", "#", "Par", "e", "the", "JSON", "object", "in", "your", "databa", "e", "42", "cur", "=", "db_conn", ".", "cur", "or", "()", "43", "44", "SQL_", "tmt", "=", "****", "45", "cur", ".", "execute", "(", "****", ")", "46", "db_conn", ".", "commit", "()", "47", "ctr", "+=", "1", "48", "49", "#", "print", "a", "counter", "to", "the", "creen", "to", "how", "progre", "....", "50", "if", "(", "ctr", "%", "10000", ")", "==", "0", ":", "51", "print", "(", "\"", "%d", "line", "loaded", "to", "databa", "e", "from", "JSON", "file\"", "%", "ctr", ")", "52", "53", "#", "Clo", "e", "databa", "e", "connection", "54", "db_conn", ".", "clo", "e", "()", "55", "print", "(", "\"Databa", "e", "loading", "completed:", "%d", "record", "loaded", "\\n", "\"", "%", "ctr", ")", "56", "print", "(", "\"Connection", "to", "the", "yelp", "databa", "e", "ha", "been", "clo", "ed\"", ")", "Download", "in", "other", "format", ":", "Original", "Format", "Powered", "by", "Trac", "1.5.3", "By", "Edgewall", "Software", ".", "Vi", "it", "the", "Trac", "open", "ource", "project", "at", "http://trac.edgewall.org/"], "content_hash": "473db0b245eb45ca5410985318760475"}