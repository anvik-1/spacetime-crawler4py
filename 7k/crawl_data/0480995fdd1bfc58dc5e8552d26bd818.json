{"url": "https://grape.ics.uci.edu/wiki/asterix/raw-attachment/wiki/stats170ab-2018/hw7_template_import_tables_from_json.py", "word_count": 308, "words": ["#", "Template", "for", "Homework", "7", "#", "#", "FOR", "170A", "Student", ":", "#", "Replace", "***", "with", "appropriate", "Python", "code", "and", "value", ",", "and", "al", "o", "extend", "the", "code", "to", "read", "in", "information", "from", "the", "#", "JSON", "file", "with", "review", "data", "#", "#", "Import", "Yelp", "information", "from", "JSON", "file", "and", "put", "into", "a", "Po", "tgre", "databa", "e", "#", "Code", "for", "Stat", "170A,", "Winter", "2018", "#", "#", "For", "documentation", "on", "Yelp", "JSON", "file", "ee:", "#", "http", "://www.yelp.com/data", "et/documentation/j", "on", "#", "#", "Code", "adapted", "from:", "http", "://manoj", "aha.com/2017/03/07/", "etting-po", "tgre", "ql-python-ubuntu-yelp-data", "et-challenge/", "#", "Author:", "Manoj", "Pravakar", "Saha", "#", "Thi", "work", "i", "licen", "ed", "under", "the", "Creative", "Common", "Attribution-NonCommercial-ShareAlike", "4.0", "International", "Licen", "e.", "#", "Import", "P", "ycopg", "Po", "tgre", "adapter", "for", "Python", "import", "p", "ycopg2", "#", "Import", "Python'", "default", "JSON", "encoder", "and", "decoder", "import", "j", "on", "#", "Open", "a", "connection", "to", "the", "databa", "e", "try:", "db_conn", "=", "p", "ycopg2.connect(\"dbname='yelp'", "ho", "t='localho", "t'", "u", "er='****'", "pa", "word='****'\")", "print(\"Connected", "to", "the", "yelp", "databa", "e...\")", "except:", "print(\"Unable", "to", "connect", "to", "the", "databa", "e\")", "#", "Initialize", "an", "empty", "li", "t", "for", "temporarily", "holding", "a", "JSON", "object", "data", "=", "[]", "MAXLINES", "=", "****", "#", "option", "to", "import", "only", "up", "to", "MAXLINES", "rather", "than", "the", "whole", "file", "#", "Open", "a", "JSON", "file", "from", "the", "data", "et", "and", "read", "data", "line-by-line", "with", "open('yelp_j", "on/bu", "ine", ".j", "on')", "a", "fileobject:", "ctr", "=", "1", "for", "line", "in", "fileobject:", "if", "ctr<=MAXLINES:", "data", "=", "j", "on.load", "(line)", "#", "Par", "e", "the", "JSON", "object", "in", "your", "databa", "e", "cur", "=", "db_conn.cur", "or()", "SQL_", "tmt", "=", "****", "cur.execute(", "****", ")", "db_conn.commit()", "ctr", "+=1", "#", "print", "a", "counter", "to", "the", "creen", "to", "how", "progre", "....", "if", "(ctr", "%", "10000)==0:", "print(\"%d", "line", "loaded", "to", "databa", "e", "from", "JSON", "file\"", "%", "ctr)", "#", "Clo", "e", "databa", "e", "connection", "db_conn.clo", "e()", "print(\"Databa", "e", "loading", "completed:", "%d", "record", "loaded\\n\"", "%", "ctr)", "print(\"Connection", "to", "the", "yelp", "databa", "e", "ha", "been", "clo", "ed\")"], "content_hash": "72d499354fba341896e56de824c124e8"}