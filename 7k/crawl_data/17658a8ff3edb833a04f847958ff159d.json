{"url": "https://seal.ics.uci.edu/projects/terminator/tla_module.html", "word_count": 715, "words": ["SEAL", "-", "Terminator", "TLA+", "Android", "Module", "---------------------------", "MODULE", "AndroidRuntime", "---------------------------", "CONSTANT", "App", ",", "\\*", "The", "et", "of", "all", "app", "in", "talled", "in", "the", "device.", "Perm", ",", "\\*", "The", "et", "of", "all", "permi", "ion", "defined", "in", "Android", "or", "by", "App", "develoepr", "(i.e.", "cu", "tom", "permi", "ion", ").", "SinkPerm", ",", "SourcePerm", ",", "\\*", "Only", "to", "di", "tingui", "h", "ink", "and", "ource", "perm", "Cu", "tomPerm", ",", "\\*", "A", "Set", "of", "cu", "tom", "permi", "on", "defined", "by", "app", "developer", "AppReqPerm", ",", "\\*", "A", "function,", "where", "AppReqPerm", "[app]", "i", "the", "et", "of", "permi", "ion", "reque", "ted", "by", "App", "app", "AppDecPerm", ",", "\\*", "A", "function,", "where", "AppReqPerm", "[app]", "i", "the", "et", "of", "permi", "ion", "declared", "by", "App", "app", "UnprotectedDB,", "\\*", "The", "et", "of", "app", "with", "unprotected", "DBS", "UnprotectedIntentFilter", "\\*", "A", "function,", "where", "AppIntentFilter[app,", "perm]", "determine", "whether", "app", "intentFilter", "that", "expo", "ed", "a", "perm-required", "capability", "i", "protected", "ASSUME", "AppReqPerm", "\\in", "[App", "->", "SUBSET", "Perm", "]", "ASSUME", "AppDecPerm", "\\in", "[App", "->", "SUBSET", "Cu", "tomPerm", "]", "ASSUME", "UnprotectedDB", "\\in", "SUBSET", "App", "ASSUME", "UnprotectedIntentFilter", "\\in", "SUBSET", "(App", "\\X", "Perm", ")", "ASSUME", "SinkPerm", "\\", "ub", "eteq", "Perm", "ASSUME", "SourcePerm", "\\", "ub", "eteq", "Perm", "ASSUME", "Cu", "tomPerm", "\\", "ub", "eteq", "Perm", "-----------------------------------------------------------------------------", "VARIABLES", "appStat,", "\\*", "The", "tate", "of", "an", "application", "permStat,", "\\*", "The", "tate", "of", "a", "permi", "ion", "dbStat,", "\\*", "The", "tate", "of", "the", "phone", "db", "collidingPerm", "\\*", "The", "tate", "of", "permi", "ion", "TypeInvariant", "==", "/\\", "appStat", "\\in", "[App", "->", "{\"Unin", "talled\",", "\"Terminated\",", "\"Running\"}]", "/\\", "permStat", "\\in", "[(App", "\\X", "Perm", ")", "->", "{\"Granted\",", "\"Revoked\"}]", "/\\", "dbStat", "\\in", "[App", "->", "{\"Sen", "itive\",", "\"Clear\"}]", "/\\", "collidingPerm", "\\in", "[App", "->", "{\"Unique\",", "\"Colliding\"}]", "Init", "==", "/\\", "appStat", "=", "[app", "\\in", "App", "|->", "\"Unin", "talled\"]", "\\*", "App", "app", "are", "not", "in", "talled", "initially", "/\\", "permStat", "=", "[<", ">", "\\in", "(App", "\\X", "Perm", ")", "|->", "\"Revoked\"]", "\\*", "No", "permi", "ion", "i", "granted", "initially", "/\\", "dbStat", "=", "[app", "\\in", "App", "|->", "\"Clear\"]", "\\*", "All", "app", "DB", "are", "initially", "empty", "/\\", "collidingPerm", "=", "[app", "\\in", "(App", ")", "|->", "\"Unique\"]", "-----------------------------------------------------------------------------", "CollidePerm(app)", "==", "IF", "\\E", "perm", "\\in", "AppDecPerm", "[app],", "oldApp", "\\in", "App", ":", "/\\", "appStat[oldApp]", "#", "\"Unin", "talled\"", "/\\", "perm", "\\in", "AppDecPerm", "[oldApp]", "\\inter", "ect", "AppDecPerm", "[app]", "/\\", "perm", "\\in", "AppReqPerm", "[oldApp]", "THEN", "/\\", "collidingPerm", "'", "=", "[collidingPerm", "EXCEPT", "![app]=", "\"Colliding\"]", "ELSE", "/\\", "UNCHANGED", "collidingPerm", "In", "tall(app)", "==", "/\\", "appStat[app]", "=", "\"Unin", "talled\"", "/\\", "appStat'", "=", "[appStat", "EXCEPT", "![app]=\"Terminated\"]", "/\\", "CollidePerm(app)", "/\\", "UNCHANGED", "<", ">", "Unin", "tall(app)", "==", "/\\", "appStat[app]", "#", "\"Unin", "talled\"", "/\\", "appStat'", "=", "[appStat", "EXCEPT", "![app]=\"Unin", "talled\"]", "/\\", "UNCHANGED", "<", ">", "Run(app)", "==", "/\\", "appStat[app]", "=", "\"Terminated\"", "/\\", "appStat'", "=", "[appStat", "EXCEPT", "![app]=\"Running\"]", "/\\", "UNCHANGED", "<", ">", "Terminate(app)", "==", "/\\", "appStat[app]", "=", "\"Running\"", "/\\", "appStat'", "=", "[appStat", "EXCEPT", "![app]=\"Terminated\"]", "/\\", "UNCHANGED", "<", ">", "Grant(app,", "perm)", "==", "/\\", "appStat[app]", "#", "\"Unin", "talled\"", "/\\", "permStat[<", ">]", "=", "\"Revoked\"", "/\\", "perm", "\\in", "AppReqPerm", "[app]", "/\\", "permStat'", "=", "[permStat", "EXCEPT", "![<", ">]=\"Granted\"]", "/\\", "UNCHANGED", "<", ">", "Revoke(app,", "perm)", "==", "/\\", "appStat[app]", "#", "\"Unin", "talled\"", "/\\", "permStat[<", ">]", "=", "\"Granted\"", "/\\", "perm", "\\in", "AppReqPerm", "[app]", "/\\", "permStat'", "=", "[permStat", "EXCEPT", "![<", ">]=\"Revoked\"]", "/\\", "UNCHANGED", "<", ">", "StoreUnprotected(app,", "perm)", "==", "/\\", "appStat[app]", "=", "\"Running\"", "/\\", "permStat[<", ">]", "=", "\"Granted\"", "/\\", "perm", "\\in", "SourcePerm", "/\\", "app", "\\in", "UnprotectedDB", "/\\", "dbStat'", "=", "[dbStat", "EXCEPT", "![app]=\"Sen", "itive\"]", "/\\", "UNCHANGED", "<", ">", "Next", "==", "\\E", "app", "\\in", "App", ":", "\\/", "In", "tall(app)", "\\/", "Run(app)", "\\/", "Terminate(app)", "\\/", "Unin", "tall(app)", "\\/", "\\E", "perm", "\\in", "Perm", ":", "Grant(app,", "perm)", "\\/", "Revoke", "(app,", "perm)", "\\/", "StoreUnprotected(app,", "perm)", "-----------------------------------------------------------------------------", "Spec", "==", "Init", "/\\", "[][Next]_<", ">", "-----------------------------------------------------------------------------", "NoPDL", "==", "\\A", "app", "\\in", "App", ":", "\\/", "dbStat[app]", "=", "\"Clear\"", "\\/", "~", "(\\E", "malApp", "\\in", "App", ",", "perm", "\\in", "Perm", ":", "/\\", "perm", "\\in", "AppReqPerm", "[malApp]", "/\\", "perm", "\\in", "SinkPerm", "/\\", "app", "#", "malApp", "/\\", "appStat[malApp]", "=", "\"Running\"", "/\\", "permStat[<", ">]", "=", "\"Granted\")", "NoPE", "==", "\\A", "filter", "\\in", "UnprotectedIntentFilter:", "\\/", "appStat[filter[1]]", "#", "\"Running\"", "\\/", "permStat[filter]", "#", "\"Granted\"", "\\/", "~", "(\\E", "malApp", "\\in", "App", ",", "perm", "\\in", "Perm", ":", "/\\", "perm", "\\in", "AppReqPerm", "[malApp]", "/\\", "perm", "=", "filter[2]", "/\\", "malApp", "#", "filter[1]", "/\\", "appStat[malApp]", "=", "\"Running\"", "/\\", "permStat[<", ">]", "=", "\"Granted\")", "NoICP", "==", "~", "(\\E", "app", "\\in", "App", ",", "malApp", "\\in", "App", ",", "perm", "\\in", "Perm", ":", "/\\", "app", "#", "malApp", "/\\", "collidingPerm", "[app]", "=", "\"Colliding\"", "/\\", "perm", "\\in", "AppDecPerm", "[app]", "/\\", "perm", "\\in", "AppDecPerm", "[malApp]", "/\\", "perm", "\\in", "AppReqPerm", "[malApp]", "/\\", "appStat[malApp]", "=", "\"Running\"", "/\\", "permStat[<", ">]", "=", "\"Granted\")", "THEOREM", "Spec", "=>", "TypeInvariant", "/\\", "NoPDL", "/\\", "NoPE", "/\\", "NoICP", "============================================================================="], "content_hash": "ee185a760b003b11d9fe3256dd56644c"}