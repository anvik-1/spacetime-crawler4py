{"url": "http://www.ics.uci.edu/~kay/scheme/infx-tunes.rkt", "word_count": 2394, "words": [";;", "InfxTunes:", "A", "Music", "Manager", ";;", "Originally", "by", "Alex", "Thornton,", "Fall", "2006.", ";;", "Modified", "by", "David", "G.", "Kay,", "Fall", "2007", "and", "Fall", "2008.", ";;", "Use", "DrScheme's", "Intermediate", "Student", "with", "Lambda", "language.", ";", ";", ";;", ";;", ";", ";", ";", ";", ";", ";", ";", ";;", ";", ";;;;;", ";;", ";;", ";;", ";;;", ";;;", ";;;;;", ";;;;", ";;", ";;;", ";;;;", ";", ";", ";", ";", ";", ";;", ";", ";", ";;", ";;", ";", ";", ";;;", ";;", ";;", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";;", ";", ";", ";", ";", ";", ";", ";;;;", ";", ";", ";", ";", ";", ";", ";", ";", ";", ";;;;", ";", ";", ";", ";", ";;", ";", ";", ";", ";", ";", ";", ";;", ";", ";", ";", ";", ";", ";", ";;;;", ";;", ";", ";", ";", ";", ";;;;;;;;;", ";;;;;", ";;;;;;;;;", ";;;", ";;;", ";;", ";;;;", ";;;;", ";;;", ";;;", ";;;;", ";", ";", ";", ";", ";", ";", ";", ";", ";;", "An", "album", "is:", ";;", "*", "a", "unique", "ID", "number", "[number]", ";;", "*", "an", "artist", "[string]", ";;", "*", "a", "title", "[string]", ";;", "*", "a", "year", "of", "release", "[number]", ";;", "*", "a", "list", "of", "songs", "[list-of-songs]", ";;", "A", "song", "is:", ";;", "*", "a", "track", "number", "[number]", ";;", "*", "a", "title", "[string]", ";;", "*", "a", "length", "in", "seconds", "[number]", ";;", "*", "a", "play", "count", "[number]", "-", "how", "many", "times", "have", "I", "listened", "to", "it?", "(define-struct", "album", "(id", "artist", "title", "year", "songs))", "(define-struct", "song", "(track-num", "title", "length", "play-count))", "(define", "MUSIC", "(list", "(make-album", "1", "\"Peter", "Gabriel\"", "\"Up\"", "2002", "(list", "(make-song", "1", "\"Darkness\"", "411", "5)", "(make-song", "2", "\"Growing", "Up\"", "453", "5)", "(make-song", "3", "\"Sky", "Blue\"", "397", "2)", "(make-song", "4", "\"No", "Way", "Out\"", "473", "2)", "(make-song", "5", "\"I", "Grieve\"", "444", "2)", "(make-song", "6", "\"The", "Barry", "Williams", "Show\"", "735", "1)", "(make-song", "7", "\"My", "Head", "Sounds", "Like", "That\"", "389", "1)", "(make-song", "8", "\"More", "Than", "This\"", "362", "1)", "(make-song", "9", "\"Signal", "to", "Noise\"", "456", "2)", "(make-song", "10", "\"The", "Drop\"", "179", "1)))", "(make-album", "2", "\"Simple", "Minds\"", "\"Once", "Upon", "a", "Time\"", "1985", "(list", "(make-song", "1", "\"Once", "Upon", "a", "Time\"", "345", "9)", "(make-song", "2", "\"All", "the", "Things", "She", "Said\"", "256", "10)", "(make-song", "3", "\"Ghost", "Dancing\"", "285", "7)", "(make-song", "4", "\"Alive", "and", "Kicking\"", "326", "26)", "(make-song", "5", "\"Oh", "Jungleland\"", "314", "13)", "(make-song", "6", "\"I", "Wish", "You", "Were", "Here\"", "282", "12)", "(make-song", "7", "\"Sanctify", "Yourself\"", "297", "7)", "(make-song", "8", "\"Come", "a", "Long", "Way\"", "307", "5)))", "(make-album", "3", "\"The", "Postal", "Service\"", "\"Give", "Up\"", "2003", "(list", "(make-song", "1", "\"The", "District", "Sleeps", "Alone\"", "284", "13)", "(make-song", "2", "\"Such", "Great", "Heights\"", "266", "13)", "(make-song", "3", "\"Sleeping", "In\"", "261", "12)", "(make-song", "4", "\"Nothing", "Better\"", "226", "18)", "(make-song", "5", "\"Recycled", "Air\"", "269", "13)", "(make-song", "6", "\"Clark", "Gable\"", "294", "12)", "(make-song", "7", "\"We", "Will", "Become", "Silhouettes\"", "300", "11)", "(make-song", "8", "\"This", "Place", "is", "a", "Prison\"", "234", "9)", "(make-song", "9", "\"Brand", "New", "Colony\"", "252", "9)", "(make-song", "10", "\"Natural", "Anthem\"", "307", "7)))", "(make-album", "4", "\"Midnight", "Oil\"", "\"Blue", "Sky", "Mining\"", "1989", "(list", "(make-song", "1", "\"Blue", "Sky", "Mine\"", "258", "12)", "(make-song", "2", "\"Stars", "of", "Warburton\"", "294", "11)", "(make-song", "3", "\"Bedlam", "Bridge\"", "266", "11)", "(make-song", "4", "\"Forgotten", "Years\"", "266", "8)", "(make-song", "5", "\"Mountains", "of", "Burma\"", "296", "9)", "(make-song", "6", "\"King", "of", "the", "Mountain\"", "231", "8)", "(make-song", "7", "\"River", "Runs", "Red\"", "322", "9)", "(make-song", "8", "\"Shakers", "and", "Movers\"", "268", "9)", "(make-song", "9", "\"One", "Country\"", "353", "7)", "(make-song", "10", "\"Antarctica\"", "258", "6)))", "(make-album", "5", "\"The", "Rolling", "Stones\"", "\"Let", "It", "Bleed\"", "1969", "(list", "(make-song", "1", "\"Gimme", "Shelter\"", "272", "3)", "(make-song", "2", "\"Love", "In", "Vain\"", "259", "2)", "(make-song", "3", "\"Country", "Honk\"", "187", "0)", "(make-song", "4", "\"Live", "With", "Me\"", "213", "2)", "(make-song", "5", "\"Let", "It", "Bleed\"", "327", "2)", "(make-song", "6", "\"Midnight", "Rambler\"", "412", "1)", "(make-song", "7", "\"You", "Got", "the", "Silver\"", "170", "0)", "(make-song", "8", "\"Monkey", "Man\"", "251", "13)", "(make-song", "9", "\"You", "Can't", "Always", "Get", "What", "You", "Want\"", "448", "10)))))", ";;", "album-earlier?:", "album", "album", "->", "boolean", ";;", "Return", "true", "if", "the", "first", "input's", "year", "is", "less", "than", "the", "second's", "(define", "album-earlier?", "(lambda", "(a1", "a2)", "(<", "(album-year", "a1)", "(album-year", "a2))))", ";;", "Sort", "the", "collection", "into", "chronological", "order.", ";;", "quicksort", "(predefined):", "(listof", "X)", "(X", "X", "->", "boolean)", "->", "(listof", "X)", ";;", "Return", "original", "list", "in", "order", "according", "to", "comparison", "function.", "(check-expect", "(quicksort", "'(23", "235", "24", "632", "14", "432", "36", "23", "113)", ">)", "(list", "632", "432", "235", "113", "36", "24", "23", "23", "14))", "(check-expect", "(quicksort", "'(23", "235", "24", "632", "14", "432", "36", "23", "113)", "<)", "(list", "14", "23", "23", "24", "36", "113", "235", "432", "632))", "(check-expect", "(quicksort", "MUSIC", "album-earlier?)", "(quicksort", "MUSIC", "(lambda", "(a1", "a2)", "(<", "(album-year", "a1)", "(album-year", "a2)))))", ";;", "Sort", "in", "ascending", "order", "by", "album", "title", ";", "(quicksort", "MUSIC", "(lambda", "(a1", "a2)", "(string", "list-of-song", ";;", "Return", "the", "top", "ten", "most", "frequently", "played", "songs", "in", "the", "collection.", "(define", "top-10-songs", "(lambda", "(AL)", "(first-n", "10", "(quicksort", "(all-songs", "AL)", "play-count-greater?))))", ";;", "play-count-greater?:", "song", "song", "->", "boolean", ";;", "Return", "true", "if", "the", "first", "song's", "play-count", "is", "greater", "than", "the", "second's.", "(define", "play-count-greater?", "(lambda", "(s1", "s2)", "(>", "(song-play-count", "s1)", "(song-play-count", "s2))))", "#|", ";", "We", "can", "try", "writing", "first-n", "by", "making", "some", "simplifying", "assumptions:", ";;", "first-n-assuming:", "number", "list", "->", "list", ";;", "Return", "first", "n", "items", "on", "list,", "assuming", "there", "are", "at", "least", "that", "many", "(define", "first-n-assuming", "(lambda", "(n", "L)", "(cond", "((zero?", "n)", "empty)", "(else", "(cons", "(first", "L)", "(first-n", "(sub1", "n)", "(rest", "L)))))))", ";;", "first-n-error:", "number", "list", "->", "list", ";;", "Return", "first", "n", "items", "on", "list,", "throwing", "error", "if", "n", "longer", "than", "list", "(define", "first-n-error", "(lambda", "(n", "L)", "(cond", "((>", "n", "(length", "L))", "(error", "'first-n-error", "\"Asking", "for", "more", "items", "than", "on", "list\"))", "(else", "(first-n-assuming", "n", "L)))))", ";", "Now", "let's", "do", "it", "the", "way", "our", "InfxTunes", "application", "would", "want", "it:", ";", "If", "the", "list", "is", "shorter", "than", "n,", "just", "return", "the", "sorter", "list.", ";;", "first-n:", "number", "list", "->", "list", ";;", "Return", "the", "first", "n", "items", "on", "the", "list,", "or", "the", "whole", "list", "if", "it's", "shorter", ";", "First,", "list", "separately", "the", "(categories", "of)", "values", "for", "each", "argument,", "L", "and", "n:", ";", "AFTER", "we", "consider", "each", "case", "separately,", "we", "can", "combine", "them", "to", "shorten", "the", "code.", "(define", "first-n", "(lambda", "(n", "L)", "(cond", "((and", "(empty?", "L)", "(zero?", "n))", "empty)", "((and", "(cons?", "L)", "(zero?", "n))", "empty)", "((and", "(empty?", "L)", "(positive?", "n))", "empty)", "((and", "(cons?", "L)", "(positive?", "n))", "(cons", "(first", "L)", "(first-n", "(sub1", "n)", "(rest", "L)))))))", ";", "First", "simplification:", "(define", "first-n", "(lambda"], "content_hash": "fb800c1cb344e79afe7cc96483a14005"}