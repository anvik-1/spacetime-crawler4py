{"url": "https://grape.ics.uci.edu/wiki/asterix/attachment/wiki/stats170ab-2018/hw7_template_import_tables_from_json.py", "word_count": 434, "words": ["hw7_template_import_tables_from_json.py", "on", "stats170ab-2018", "\u2013", "Attachment", "\u2013", "ASTERIX", "Login", "Preferences", "About", "Trac", "Register", "Context", "Navigation", "Back", "to", "stats170ab-2018", "stats170ab-2018", ":", "hw7_template_import_tables_from_json.py", "File", "hw7_template_import_tables_from_json.py,", "1.8", "KB", "(added", "by", "Padhraic", "Smyth", ",", "8", "years", "ago", ")", "Python", "script", "template", "for", "Homework", "7", "Line", "1", "#", "Template", "for", "Homework", "7", "2", "#", "3", "#", "FOR", "170A", "Students:", "4", "#", "Replace", "***", "with", "appropriate", "Python", "code", "and", "values,", "and", "also", "extend", "the", "code", "to", "read", "in", "information", "from", "the", "5", "#", "JSON", "file", "with", "review", "data", "6", "#", "7", "#", "Import", "Yelp", "information", "from", "JSON", "files", "and", "put", "into", "a", "Postgres", "database", "8", "#", "Code", "for", "Stats", "170A,", "Winter", "2018", "9", "#", "10", "#", "For", "documentation", "on", "Yelp", "JSON", "files", "see:", "11", "#", "https://www.yelp.com/dataset/documentation/json", "12", "#", "13", "#", "Code", "adapted", "from:", "https://manojsaha.com/2017/03/07/setting-postgresql-python-ubuntu-yelp-dataset-challenge/", "14", "#", "Author:", "Manoj", "Pravakar", "Saha", "15", "#", "This", "work", "is", "licensed", "under", "the", "Creative", "Commons", "Attribution-NonCommercial-ShareAlike", "4.0", "International", "License.", "16", "17", "#", "Import", "Psycopg", "Postgres", "adapter", "for", "Python", "18", "import", "psycopg2", "19", "20", "#", "Import", "Python's", "default", "JSON", "encoder", "and", "decoder", "21", "import", "json", "22", "23", "#", "Open", "a", "connection", "to", "the", "database", "24", "try", ":", "25", "db_conn", "=", "psycopg2", ".", "connect", "(", "\"dbname='yelp'", "host='localhost'", "user='****'", "password='****'\"", ")", "26", "print", "(", "\"Connected", "to", "the", "yelp", "database...\"", ")", "27", "except", ":", "28", "print", "(", "\"Unable", "to", "connect", "to", "the", "database\"", ")", "29", "30", "#", "Initialize", "an", "empty", "list", "for", "temporarily", "holding", "a", "JSON", "object", "31", "data", "=", "[]", "32", "MAXLINES", "=", "****", "#", "option", "to", "import", "only", "up", "to", "MAXLINES", "rather", "than", "the", "whole", "file", "33", "34", "#", "Open", "a", "JSON", "file", "from", "the", "dataset", "and", "read", "data", "line-by-line", "35", "with", "open", "(", "'yelp_json/business.json'", ")", "as", "fileobject", ":", "36", "ctr", "=", "1", "37", "for", "line", "in", "fileobject", ":", "38", "if", "ctr", "<=", "MAXLINES", ":", "39", "data", "=", "json", ".", "loads", "(", "line", ")", "40", "41", "#", "Parse", "the", "JSON", "object", "in", "your", "database", "42", "cur", "=", "db_conn", ".", "cursor", "()", "43", "44", "SQL_stmt", "=", "****", "45", "cur", ".", "execute", "(", "****", ")", "46", "db_conn", ".", "commit", "()", "47", "ctr", "+=", "1", "48", "49", "#", "print", "a", "counter", "to", "the", "screen", "to", "show", "progress....", "50", "if", "(", "ctr", "%", "10000", ")", "==", "0", ":", "51", "print", "(", "\"", "%d", "lines", "loaded", "to", "database", "from", "JSON", "file\"", "%", "ctr", ")", "52", "53", "#", "Close", "database", "connection", "54", "db_conn", ".", "close", "()", "55", "print", "(", "\"Database", "loading", "completed:", "%d", "records", "loaded", "\\n", "\"", "%", "ctr", ")", "56", "print", "(", "\"Connection", "to", "the", "yelp", "database", "has", "been", "closed\"", ")", "Download", "in", "other", "formats:", "Original", "Format", "Powered", "by", "Trac", "1.5.3", "By", "Edgewall", "Software", ".", "Visit", "the", "Trac", "open", "source", "project", "at", "http://trac.edgewall.org/"], "content_hash": "89ba94146648c6f93d77069fa8824b23"}