{"url": "https://grape.ics.uci.edu/wiki/public/wiki/cs122b-2017-winter-project5?action=diff&version=1", "word_count": 2582, "words": ["cs122b-2017-winter-project5", "(diff)", "\u2013", "Public", "Login", "Preferences", "About", "Trac", "Register", "Context", "Navigation", "\u2190", "Previous", "Change", "Wiki", "History", "Next", "Change", "\u2192", "Changes", "between", "Initial", "Version", "and", "Version", "1", "of", "cs122b-2017-winter-project5", "View", "differences", "inline", "side", "by", "side", "Show", "lines", "around", "each", "change", "Show", "the", "changes", "in", "full", "context", "Ignore:", "Blank", "lines", "Case", "changes", "White", "space", "changes", "Timestamp:", "Mar", "2,", "2017,", "10:24:20", "PM", "(", "9", "years", "ago)", "Author:", "Chen", "Luo", "Comment:", "--", "Legend:", "Unmodified", "Added", "Removed", "Modified", "cs122b-2017-winter-project5", "v1", "v1", "1", "[[PageOutline]]", "2", "3", "=", "CS122B", "Project", "5:", "Scaling", "Fabflix", "and", "Developing", "an", "Android", "App", "=", "4", "'''Due:", "March", "17,", "2017,", "Friday,", "11:45", "pm.", "Submit", "on", "EEE.'''[[BR]]", "Notice", "that", "we", "use", "1", "day", "after", "the", "official", "deadline", "as", "the", "submission", "cut-off", "time", "on", "EEE", "to", "allow", "you", "to", "use", "the", "24-hour", "grace", "period", "if", "you", "chose", "so.", "After", "that,", "EEE", "will", "no", "longer", "accept", "submissions.", "5", "6", "This", "project", "has", "the", "following", "tasks:", "7", "8", "1.", "JDBC", "connection", "pooling", "and", "Prepared", "statements", "9", "2.", "10", "1.", "Scaling", "Fabflix", "with", "a", "cluster", "of", "MySQL/Tomcat", "and", "a", "frontend", "load", "balancer;", "11", "1.", "Implement", "a", "simple", "Android", "app", "for", "Fabflix.", "12", "13", "14", "----", "15", "==", "Task", "1:", "Connection", "Pooling", "and", "Prepared", "Statements", "==", "16", "In", "this", "task,", "we", "will", "enable", "Fabflix", "with", "Connection", "Pooling", "and", "Prepared", "Statements.", "17", "18", "'''Step", "1:'''", "Make", "the", "necessary", "changes", "and", "make", "sure", "to", "use", "Prepared", "Statements", "in", "all", "JDBC", "statements", "involved", "in", "search.", "You", "can", "use", "this", "[http://docs.oracle.com/javase/tutorial/jdbc/basics/prepared.html", "tutorial]", "on", "prepared", "statements.", "19", "20", "'''Step", "2:'''", "Enable", "JDBC", "connection", "pooling", "for", "Fabflix.", "We", "will", "use", "our", "running", "application", "of", "\"!TomcatTest\"", "to", "show", "how", "to", "change", "it", "to", "use", "connection", "pooling.", "Note:", "We", "do", "not", "know", "whether", "the", "instructions", "will", "work", "for", "JSP", "or", "not.", "21", "22", "1.", "Download", "and", "deploy", "the", "following", "[attachment:wiki:cs122b-2016-winter-project5:TomcatPooling.war", "TomcatPooling.war]", "file.", "The", "file", "'''!TomcatPooling\\META-INF\\context.xml'''", "includes", "important", "information", "about", "the", "database,", "user", "name,", "password,", "and", "pooling", "configuration.", "If", "you", "want", "to", "change", "this", "file,", "you", "need", "to", "undeploy", "the", "war", "file,", "make", "those", "changes,", "make", "a", "new", "war", "file,", "and", "deploy", "the", "new", "war", "file.", "Otherwise,", "the", "Tomcat", "server", "may", "still", "use", "the", "previous", "context.xml.", "Check", "[http://tomcat.apache.org/tomcat-8.5-doc/jndi-datasource-examples-howto.html]", "for", "more", "information", "about", "how", "to", "configure", "connection", "pooling.", "23", "1.", "Go", "to", "the", "link", "http://localhost:8080/TomcatPooling/servlet/TomcatTest", "to", "test", "your", "application.", "You", "must", "see", "a", "list", "of", "rows", "displayed", "on", "the", "webpage.", "24", "1.", "Look", "into", "the", "following", "files", "for", "the", "main", "changes", "in", "this", "war", "file", "compared", "to", "the", "previous", "war", "file", "without", "connection", "pooling:", "25", "*", "'''\\META-INF\\context.xml'''.", "26", "*", "'''\\WEB-INF\\sources\\!TomcatTest.java'''", "27", "*", "'''\\WEB-INF\\web.xml'''", "(see", "the", "'''resource-ref'''", "tag).", "28", "29", "Also,", "please", "add", "the", "MySQL", "driver", "to", "the", "'''lib'''", "directory", "of", "your", "tomcat", "installation.", "Connection", "Pooling", "will", "not", "work", "if", "the", "driver", "is", "not", "available", "here.", "And", "'''restart", "your", "server'''", "once", "this", "addition", "is", "made.", "30", "31", "You", "may", "also", "find", "some", "useful", "links", "for", "connection", "pooling", "from", "[http://archive.oreilly.com/pub/a/onjava/2006/04/19/database-connection-pooling-with-tomcat.html?page=1", "this", "tutorial],[https://www.mulesoft.com/tcat/tomcat-mysql", "link1],", "[https://examples.javacodegeeks.com/enterprise-java/tomcat/tomcat-connection-pool-configuration-example/", "link2],", "[https://people.apache.org/~fhanik/jdbc-pool/jdbc-pool.html", "link3]", "32", "33", "'''Note''':", "for", "setting", "up", "JDBC", "Connection", "Pooling", "on", "the", "AWS", "Ubuntu", "platform,", "add", "the", "MySQL", "driver", "to'''/opt/tomcat8.5/lib/", "'''and", "restart", "your", "server.", "34", "35", "__'''When", "you", "are", "done,'''__", "write", "an", "explanation", "of", "how/where", "you", "use", "the", "JDBC", "connection", "pooling", "in", "your", "code.", "You", "should", "submit", "this", "report", "to", "EEE.", "36", "37", "----", "38", "==", "Task", "2:", "Scaling", "Fabflix", "==", "39", "'''Step", "1''':", "Setup", "two", "AWS", "instances", "as", "two", "backend", "servers.", "We", "call", "them", "the", "\"master", "instance\"", "and", "the", "\"slave", "instance\"", "(in", "the", "context", "of", "MySQL", "replication).", "Learn", "how", "to", "do", "MySQL", "replication", "using", "these", "two", "instances", "by", "following", "this", "[https://grape.ics.uci.edu/wiki/public/wiki/cs122b-2016-spring-project5-mysql-master-slave", "MySQL", "replication", "tutorial].", "40", "41", "'''Step", "2", "(master/slave)''':", "On", "each", "instance,", "uninstall", "the", "old", "MySQL", "and", "re-install", "it", "([http://askubuntu.com/questions/172514/how-do-i-uninstall-mysql", "reference]):", "42", "43", "{{{", "44", "shell>", "sudo", "apt-get", "purge", "mysql-server", "mysql-client", "mysql-common", "mysql-server-core-5.5", "mysql-client-core-5.5", "45", "shell>", "sudo", "rm", "-rf", "/etc/mysql", "/var/lib/mysql", "46", "shell>", "sudo", "apt-get", "autoremove", "47", "shell>", "sudo", "apt-get", "autoclean", "48", "shell>", "49", "shell>", "sudo", "apt-get", "update", "50", "shell>", "sudo", "apt-get", "install", "mysql-server", "51", "shell>", "sudo", "service", "mysql", "restart", "52", "}}}", "53", "1.", "Create", "a", "database", "\"moviedb\".", "Download", "the", "following", "MySQL", "dump", "file", "[attachment:movie-dump.sql].", "Use", "it", "to", "populate", "the", "\"moviedb\"", "database:", "54", "{{{", "55", "shell>", "mysql", "-u", "root", "-p", "moviedb", "<", "movie-dump.sql", "56", "}}}", "57", "1.", "Create", "a", "dummy", "user", "for", "two", "example", "Tomcat", "applications:", "58", "{{{", "59", "shell>", "mysql", "-u", "root", "-p", "60", "mysql>", "CREATE", "USER", "'testuser'@'localhost'", "IDENTIFIED", "BY", "'testpass';", "61", "mysql>", "GRANT", "ALL", "ON", "*.*", "TO", "'testuser'@'localhost';", "62", "}}}", "63", "64", "'''Step", "3", "(master/slave)''':", "Setup", "Tomcat", "on", "each", "master/slave", "instance", "by", "following", "the", "[https://www.digitalocean.com/community/tutorials/how-to-install-apache-tomcat-7-on-ubuntu-14-04-via-apt-get", "instructions].", "(You", "should", "have", "done", "it", "many", "times.)", "65", "66", "'''Step", "4", "(master/slave)''':", "On", "each", "master/slave", "instance,", "deploy", "[https://grape.ics.uci.edu/wiki/public/attachment/wiki/cs122b-2016-spring-project2/TomcatTest.war", "TomcatTest.war].", "Make", "the", "URL", "http://PUBLIC_IP:8080/TomcatTest/servlet/TomcatTest", "work.", "Make", "sure", "to", "modify", "the", "AWS", "security", "group", "setting", "for", "these", "two", "instances", "to", "allow", "remote", "access", "to", "their", "8080", "port.", "67", "68", "'''Step", "5", "(master/slave)''':", "On", "each", "master/slave", "instance,", "deploy", "[https://grape.ics.uci.edu/wiki/public/attachment/wiki/cs122b-2016-spring-project2/Session.war", "Session.war].", "Make", "the", "URL", "http://PUBLIC_IP:8080/Session/servlet/ShowSession?myname=Michael", "work.", "69", "70", "'''Step", "6", "(instance", "1)''':", "On", "the", "instance", "that", "runs", "the", "original", "Fablix", "instance", "(called", "\"instance", "1\"),", "setup", "Apache", "and", "its", "proxy", "by", "doing", "the", "following:", "71", "72", "1.", "Install", "Apache2", "and", "related", "modules:", "73", "{{{", "74", "instance1-shell>", "sudo", "apt-get", "install", "apache2", "75", "instance1-shell>", "service", "apache2", "restart", "76", "instance1-shell>", "sudo", "a2enmod", "proxy", "proxy_balancer", "proxy_http", "rewrite", "headers", "lbmethod_byrequests", "77", "}}}", "78", "1.", "Configure", "the", "Apache2", "web", "server", "to", "use", "its", "`proxy_balancer`", "module", "for", "sharing", "(i.e.,", "redirecting)", "requests", "to", "the", "backend", "instances.", "To", "do", "it,", "edit", "the", "following", "configuration", "file:", "79", "{{{", "80", "instance1-shell>", "sudo", "vim", "/etc/apache2/sites-enabled/000-default.conf", "81", "}}}", "82", "83", "Create", "a", "load", "balancer", "proxy,", "whose", "members", "are", "the", "backend", "instances.", "In", "particular,", "define", "a", "proxy", "on", "top", "of", "the", "file,", "before", "the", "`<VirtualHost", "*:80>`", "tag.[[BR]]", "84", "85", "{{{", "86", "<Proxy", "\"balancer://TomcatTest_balancer\">", "87", "BalancerMember", "\"http://172.2.2.2:8080/TomcatTest/\"", "88", "BalancerMember", "\"http://172.3.3.3:8080/TomcatTest/\"", "89", "</Proxy>", "90", "}}}", "91", "Here", "we", "assume", "'172.2.2.2'", "and", "'172.3.3.3'", "are", "the", "private", "IP", "address", "of", "the", "master", "and", "slave", "instances,", "respectively.", "92", "93", "1.", "Add", "two", "new", "rules", "in", "the", "body", "of", "the", "!VirtualHost", "tag.[[BR]]", "94", "{{{", "95", "ProxyPass", "/TomcatTest", "balancer://TomcatTest_balancer", "96", "ProxyPassReverse", "/TomcatTest", "balancer://TomcatTest_balancer", "97", "}}}", "98", "1.", "Restart", "Apache:", "99", "{{{", "100", "instance1-shell>", "sudo", "service", "apache2", "restart", "101", "}}}", "102", "1.", "Modify"], "content_hash": "70fe6a396bd43ac253c0efeb3f447e5a"}