{"url": "https://grape.ics.uci.edu/wiki/asterix/raw-attachment/wiki/stats170ab-2018/hw7_template_import_tables_from_json.py", "word_count": 260, "words": ["#", "Template", "for", "Homework", "7", "#", "#", "FOR", "170A", "Students:", "#", "Replace", "***", "with", "appropriate", "Python", "code", "and", "values,", "and", "also", "extend", "the", "code", "to", "read", "in", "information", "from", "the", "#", "JSON", "file", "with", "review", "data", "#", "#", "Import", "Yelp", "information", "from", "JSON", "files", "and", "put", "into", "a", "Postgres", "database", "#", "Code", "for", "Stats", "170A,", "Winter", "2018", "#", "#", "For", "documentation", "on", "Yelp", "JSON", "files", "see:", "#", "https://www.yelp.com/dataset/documentation/json", "#", "#", "Code", "adapted", "from:", "https://manojsaha.com/2017/03/07/setting-postgresql-python-ubuntu-yelp-dataset-challenge/", "#", "Author:", "Manoj", "Pravakar", "Saha", "#", "This", "work", "is", "licensed", "under", "the", "Creative", "Commons", "Attribution-NonCommercial-ShareAlike", "4.0", "International", "License.", "#", "Import", "Psycopg", "Postgres", "adapter", "for", "Python", "import", "psycopg2", "#", "Import", "Python's", "default", "JSON", "encoder", "and", "decoder", "import", "json", "#", "Open", "a", "connection", "to", "the", "database", "try:", "db_conn", "=", "psycopg2.connect(\"dbname='yelp'", "host='localhost'", "user='****'", "password='****'\")", "print(\"Connected", "to", "the", "yelp", "database...\")", "except:", "print(\"Unable", "to", "connect", "to", "the", "database\")", "#", "Initialize", "an", "empty", "list", "for", "temporarily", "holding", "a", "JSON", "object", "data", "=", "[]", "MAXLINES", "=", "****", "#", "option", "to", "import", "only", "up", "to", "MAXLINES", "rather", "than", "the", "whole", "file", "#", "Open", "a", "JSON", "file", "from", "the", "dataset", "and", "read", "data", "line-by-line", "with", "open('yelp_json/business.json')", "as", "fileobject:", "ctr", "=", "1", "for", "line", "in", "fileobject:", "if", "ctr<=MAXLINES:", "data", "=", "json.loads(line)", "#", "Parse", "the", "JSON", "object", "in", "your", "database", "cur", "=", "db_conn.cursor()", "SQL_stmt", "=", "****", "cur.execute(", "****", ")", "db_conn.commit()", "ctr", "+=1", "#", "print", "a", "counter", "to", "the", "screen", "to", "show", "progress....", "if", "(ctr", "%", "10000)==0:", "print(\"%d", "lines", "loaded", "to", "database", "from", "JSON", "file\"", "%", "ctr)", "#", "Close", "database", "connection", "db_conn.close()", "print(\"Database", "loading", "completed:", "%d", "records", "loaded\\n\"", "%", "ctr)", "print(\"Connection", "to", "the", "yelp", "database", "has", "been", "closed\")"], "content_hash": "41a8b98a690d3faee47338336d16c616"}