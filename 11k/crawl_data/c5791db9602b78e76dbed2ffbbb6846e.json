{"url": "https://grape.ics.uci.edu/wiki/public/raw-attachment/wiki/cs122b-2018-spring-project2/Items.java", "word_count": 241, "words": ["import", "javax.servlet.annotation.WebServlet;", "import", "javax.servlet.http.HttpServlet;", "import", "javax.servlet.http.HttpServletRequest;", "import", "javax.servlet.http.HttpServletResponse;", "import", "javax.servlet.http.HttpSession;", "import", "java.io.IOException;", "import", "java.io.PrintWriter;", "import", "java.util.ArrayList;", "//", "Declaring", "a", "WebServlet", "called", "ItemServlet,", "which", "maps", "to", "url", "\"/items\"", "@WebServlet(name", "=", "\"ItemServlet\",", "urlPatterns", "=", "\"/items\")", "public", "class", "Items", "extends", "HttpServlet", "{", "public", "void", "doGet(HttpServletRequest", "request,", "HttpServletResponse", "response)", "throws", "IOException", "{", "HttpSession", "session", "=", "request.getSession();", "//", "Get", "a", "instance", "of", "current", "session", "on", "the", "request", "ArrayList", "previousItems", "=", "(ArrayList", ")", "session.getAttribute(\"previousItems\");", "//", "Retrieve", "data", "named", "\"previousItems\"", "from", "session", "//", "If", "\"previousItems\"", "is", "not", "found", "on", "session,", "means", "this", "is", "a", "new", "user,", "thus", "we", "create", "a", "new", "previousItems", "ArrayList", "for", "the", "user", "if", "(previousItems", "==", "null)", "{", "previousItems", "=", "new", "ArrayList<>();", "session.setAttribute(\"previousItems\",", "previousItems);", "//", "Add", "the", "newly", "created", "ArrayList", "to", "session,", "so", "that", "it", "could", "be", "retrieved", "next", "time", "}", "String", "newItem", "=", "request.getParameter(\"newItem\");", "//", "Get", "parameter", "that", "sent", "by", "GET", "request", "url", "response.setContentType(\"text/html\");", "PrintWriter", "out", "=", "response.getWriter();", "String", "title", "=", "\"Items", "Purchased\";", "String", "docType", "=", "\"", "\\n\";", "out.println(String.format(\"%s\\n", "%s", "\\n\\n", "%s", "\",", "docType,", "title,", "title));", "//", "Inorder", "to", "prevent", "multiple", "clients,", "requests", "from", "altering", "previousItems", "ArrayList", "at", "the", "same", "time,", "we", "lock", "the", "ArrayList", "while", "updating", "synchronized", "(previousItems)", "{", "if", "(newItem", "!=", "null)", "{", "previousItems.add(newItem);", "//", "Add", "the", "new", "item", "to", "the", "previousItems", "ArrayList", "}", "//", "Display", "the", "current", "previousItems", "ArrayList", "if", "(previousItems.size()", "==", "0)", "{", "out.println(\"", "No", "items", "\");", "}", "else", "{", "out.println(\"", "\");", "for", "(Object", "previousItem", ":", "previousItems)", "{", "out.println(\"", "\"", "+", "previousItem);", "}", "out.println(\"", "\");", "}", "}", "out.println(\"\");", "}", "}"], "content_hash": "97aaa11ac48dff95d8f225122be47d3d"}