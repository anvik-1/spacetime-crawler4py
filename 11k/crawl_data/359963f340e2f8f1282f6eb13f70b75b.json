{"url": "https://grape.ics.uci.edu/wiki/public/attachment/wiki/cs122b-2018-spring-project2/Items.java", "word_count": 458, "words": ["Items.java", "on", "cs122b-2018-spring-project2", "\u2013", "Attachment", "\u2013", "Public", "Login", "Preferences", "About", "Trac", "Register", "Context", "Navigation", "Back", "to", "cs122b-2018-spring-project2", "cs122b-2018-spring-project2", ":", "Items.java", "File", "Items.java,", "2.5", "KB", "(added", "by", "yicongh1", ",", "8", "years", "ago", ")", "Line", "1", "import", "javax.servlet.annotation.WebServlet", ";", "2", "import", "javax.servlet.http.HttpServlet", ";", "3", "import", "javax.servlet.http.HttpServletRequest", ";", "4", "import", "javax.servlet.http.HttpServletResponse", ";", "5", "import", "javax.servlet.http.HttpSession", ";", "6", "import", "java.io.IOException", ";", "7", "import", "java.io.PrintWriter", ";", "8", "import", "java.util.ArrayList", ";", "9", "10", "//", "Declaring", "a", "WebServlet", "called", "ItemServlet,", "which", "maps", "to", "url", "\"/items\"", "11", "@WebServlet", "(", "name", "=", "\"ItemServlet\"", ",", "urlPatterns", "=", "\"/items\"", ")", "12", "13", "public", "class", "Items", "extends", "HttpServlet", "{", "14", "public", "void", "doGet", "(", "HttpServletRequest", "request", ",", "15", "HttpServletResponse", "response", ")", "throws", "IOException", "{", "16", "17", "HttpSession", "session", "=", "request", ".", "getSession", "();", "//", "Get", "a", "instance", "of", "current", "session", "on", "the", "request", "18", "ArrayList", "<", "String", ">", "previousItems", "=", "(", "ArrayList", "<", "String", ">", ")", "session", ".", "getAttribute", "(", "\"previousItems\"", ");", "//", "Retrieve", "data", "named", "\"previousItems\"", "from", "session", "19", "20", "//", "If", "\"previousItems\"", "is", "not", "found", "on", "session,", "means", "this", "is", "a", "new", "user,", "thus", "we", "create", "a", "new", "previousItems", "ArrayList", "for", "the", "user", "21", "if", "(", "previousItems", "==", "null", ")", "{", "22", "previousItems", "=", "new", "ArrayList", "<>", "();", "23", "session", ".", "setAttribute", "(", "\"previousItems\"", ",", "previousItems", ");", "//", "Add", "the", "newly", "created", "ArrayList", "to", "session,", "so", "that", "it", "could", "be", "retrieved", "next", "time", "24", "25", "}", "26", "27", "String", "newItem", "=", "request", ".", "getParameter", "(", "\"newItem\"", ");", "//", "Get", "parameter", "that", "sent", "by", "GET", "request", "url", "28", "29", "response", ".", "setContentType", "(", "\"text/html\"", ");", "30", "PrintWriter", "out", "=", "response", ".", "getWriter", "();", "31", "String", "title", "=", "\"Items", "Purchased\"", ";", "32", "String", "docType", "=", "33", "\"<!DOCTYPE", "HTML", "PUBLIC", "\\\"-//W3C//DTD", "HTML", "4.0", "Transitional//EN\\\">\\n\"", ";", "34", "out", ".", "println", "(", "String", ".", "format", "(", "\"%s<html>\\n<head><title>%s</title></head>\\n<body", "bgcolor=\\\"#FDF5E6\\\">\\n<h1>%s</h1>\"", ",", "docType", ",", "title", ",", "title", "));", "35", "36", "//", "Inorder", "to", "prevent", "multiple", "clients,", "requests", "from", "altering", "previousItems", "ArrayList", "at", "the", "same", "time,", "we", "lock", "the", "ArrayList", "while", "updating", "37", "synchronized", "(", "previousItems", ")", "{", "38", "if", "(", "newItem", "!=", "null", ")", "{", "39", "previousItems", ".", "add", "(", "newItem", ");", "//", "Add", "the", "new", "item", "to", "the", "previousItems", "ArrayList", "40", "}", "41", "42", "//", "Display", "the", "current", "previousItems", "ArrayList", "43", "if", "(", "previousItems", ".", "size", "()", "==", "0", ")", "{", "44", "out", ".", "println", "(", "\"<i>No", "items</i>\"", ");", "45", "}", "else", "{", "46", "out", ".", "println", "(", "\"<ul>\"", ");", "47", "for", "(", "Object", "previousItem", ":", "previousItems", ")", "{", "48", "out", ".", "println", "(", "\"<li>\"", "+", "previousItem", ");", "49", "}", "50", "out", ".", "println", "(", "\"</ul>\"", ");", "51", "}", "52", "}", "53", "54", "out", ".", "println", "(", "\"</body></html>\"", ");", "55", "}", "56", "}", "Download", "in", "other", "formats:", "Original", "Format", "Powered", "by", "Trac", "1.5.3", "By", "Edgewall", "Software", ".", "Visit", "the", "Trac", "open", "source", "project", "at", "http://trac.edgewall.org/"], "content_hash": "c3bce6706a8deed33de698fbe5bf3ca7"}