{"url": "https://grape.ics.uci.edu/wiki/public/wiki/cs122b-2019-winter-project5-mysql-master-slave?action=diff&version=1", "word_count": 966, "words": ["cs122b-2019-winter-project5-mysql-master-slave", "(diff)", "\u2013", "Public", "Login", "Preferences", "About", "Trac", "Register", "Context", "Navigation", "\u2190", "Previous", "Change", "Wiki", "History", "Next", "Change", "\u2192", "Changes", "between", "Initial", "Version", "and", "Version", "1", "of", "cs122b-2019-winter-project5-mysql-master-slave", "View", "differences", "inline", "side", "by", "side", "Show", "lines", "around", "each", "change", "Show", "the", "changes", "in", "full", "context", "Ignore:", "Blank", "lines", "Case", "changes", "White", "space", "changes", "Timestamp:", "Feb", "28,", "2019,", "8:12:06", "PM", "(", "7", "years", "ago)", "Author:", "Avinash", "Comment:", "--", "Legend:", "Unmodified", "Added", "Removed", "Modified", "cs122b-2019-winter-project5-mysql-master-slave", "v1", "v1", "1", "===", "MySQL", "Master-Slave", "Replication", "===", "2", "This", "tutorial", "shows", "how", "to", "setup", "a", "MySQL", "cluster", "on", "AWS", "that", "includes", "a", "master", "and", "a", "slave.", "Reads", "can", "be", "sent", "to", "any", "of", "the", "two", "instances,", "and", "writes", "have", "to", "be", "sent", "to", "the", "master", "instance.", "3", "4", "1.", "Setup", "two", "new", "AWS", "instances:", "5", "i.", "Create", "two", "new", "AWS", "instances", "identical", "to", "your", "previous", "instance", "used", "to", "run", "Fabflix.", "We", "call", "these", "\"instance", "2\"", "(as", "the", "master)", "and", "\"instance", "3\"'", "(as", "the", "slave).", "We", "assume", "their", "public", "IPs", "are", "2.2.2.2", "and", "3.3.3.3,", "and", "their", "internal", "AWS", "IPs", "are", "172.2.2.2", "and", "172.3.3.3,", "respectively.", "6", "i.", "Add", "new", "rules", "in", "their", "security", "group(s)", "to", "open", "their", "`MYSQL/Aurora`", "type", "to", "each", "other", "using", "their", "AWS", "internal", "IP.", "7", "1.", "Watch", "[https://www.youtube.com/watch?v=JXDuVypcHNA", "this", "video]", "to", "have", "a", "good", "understanding", "of", "this", "feature.", "The", "following", "steps", "are", "mainly", "based", "on", "those", "instructions", "in", "the", "video.", "8", "1.", "Set", "up", "the", "master", "instance.", "9", "i.", "SSH", "to", "the", "master", "instance.", "Run", "the", "following", "command", "to", "install", "MySQL", "server.", "10", "{{{", "11", "master-shell>", "sudo", "apt-get", "update", "12", "master-shell>", "sudo", "apt-get", "install", "mysql-server", "13", "}}}", "14", "i.", "Edit", "the", "`/etc/mysql/mysql.conf.d/mysqld.cnf`", "file", "and", "set", "the", "`bind-address`", "to", "'''0.0.0.0'''.", "Also,", "uncomment", "the", "lines", "of", "`server-id`", "and", "`log_bin`", "properties.", "15", "i.", "Restart", "the", "MySQL", "service.", "16", "{{{", "17", "master-shell>", "sudo", "service", "mysql", "restart", "18", "}}}", "19", "i.", "Login", "to", "the", "MySQL", "console.", "Create", "a", "new", "user", "and", "give", "it", "the", "permission", "for", "replicating", "the", "database:[[BR]]", "20", "{{{", "21", "master-shell>", "mysql", "-u", "root", "-p", "22", "master-mysql>", "create", "user", "'repl'@'%'", "identified", "by", "'slavepassword';", "23", "master-mysql>", "grant", "replication", "slave", "on", "*.*", "to", "'repl'@'%'", ";", "24", "}}}", "25", "i.", "Run", "the", "following", "command", "in", "MySQL", "console", "to", "get", "the", "status", "about", "the", "master", "MySQL:[[BR]]", "26", "{{{", "27", "master-mysql>", "show", "master", "status;", "28", "}}}", "29", "Keep", "the", "values", "of", "the", "`File`", "and", "`Position`", "columns,", "as", "they", "are", "needed", "in", "the", "next", "step.", "For", "example,", "these", "values", "are", "`mysql-bin.000001`", "and", "`337`.", "30", "1.", "Set", "up", "the", "slave", "instance:", "31", "i.", "SSH", "to", "the", "slave", "instance.", "Run", "the", "following", "commands", "to", "install", "MySQL", "server.", "32", "{{{", "33", "slave-shell>", "sudo", "apt-get", "update", "34", "slave-shell>", "sudo", "apt-get", "install", "mysql-server", "35", "}}}", "36", "i.", "Edit", "the", "`/etc/mysql/mysql.conf.d/mysqld.cnf`", "file", "and", "set", "the", "`bind-address`", "to", "'''0.0.0.0'''.", "Also,", "uncomment", "the", "`server-id`", "property", "and", "use", "value", "2.", "Do", "'''not'''", "uncomment", "the", "`log_bin`", "property.", "37", "i.", "Restart", "the", "MySQL", "service.", "38", "{{{", "39", "slave-shell>", "sudo", "service", "mysql", "restart", "40", "}}}", "41", "i.", "Login", "to", "the", "MySQL", "console", "and", "let", "the", "slave", "know", "about", "the", "master", "server:[[BR]]", "42", "{{{", "43", "slave-shell>", "mysql", "-u", "root", "-p", "44", "slave-mysql>", "CHANGE", "MASTER", "TO", "MASTER_HOST='172.2.2.2',", "MASTER_USER='repl',", "MASTER_PASSWORD='slavepassword',", "MASTER_LOG_FILE='mysql-bin.000001',", "MASTER_LOG_POS=337;", "45", "}}}", "46", "Note", "that", "the", "values", "used", "for", "`MASTER_LOG_FILE`", "and", "`MASTER_LOG_POS`", "are", "the", "ones", "from", "the", "last", "step.", "47", "i.", "Start", "the", "MySQL", "slave:[[BR]]", "48", "{{{", "49", "slave-mysql>", "start", "slave;", "50", "slave-mysql>", "show", "slave", "status;", "51", "}}}", "52", "It", "should", "show", "\"Slave_IO_State:", "Waiting", "for", "master", "to", "send", "event\".", "53", "1.", "Test", "if", "the", "synchronization", "works:", "54", "i.", "On", "the", "master", "instance,", "create", "a", "database", "with", "a", "table", "with", "a", "tuple:", "55", "{{{", "56", "master-shell>", "mysql", "-u", "root", "-p", "57", "master-mysql>", "create", "database", "pets;", "58", "master-mysql>", "use", "pets;", "59", "master-mysql>", "create", "table", "cats(name", "varchar(20));", "60", "master-mysql>", "insert", "into", "cats", "values", "(\"fluffy\");", "61", "}}}", "62", "i.", "On", "the", "slave", "instance,", "check", "if", "the", "data", "has", "been", "propagated", "from", "the", "master:", "63", "{{{", "64", "slave-shell>", "mysql", "-u", "root", "-p", "65", "slave-mysql>", "show", "databases;", "66", "slave-mysql>", "use", "pets;", "67", "slave-mysql>", "show", "tables;", "68", "slave-mysql>", "select", "*", "from", "cats;", "69", "}}}", "70", "We", "should", "be", "able", "to", "see", "the", "database,", "table,", "and", "record", "on", "this", "instance", "propagated", "from", "the", "master.", "If", "so,", "congratulations!", "71", "1.", "Create", "moviedb", "on", "the", "master", "instance:", "72", "i.", "Populate", "moviedb", "on", "master", "instance", "using", "\"create_table.sql\"", "and", "\"data.sql\"", "(You", "have", "done", "this", "many", "times)", "73", "i.", "On", "the", "slave", "instance,", "check", "if", "the", "data", "is", "automatically", "propagated:", "74", "{{{", "75", "slave-shell>", "mysql", "-u", "root", "-p", "76", "slave-mysql>", "use", "moviedb;", "show", "tables;", "77", "}}}", "78", "Note:", "The", "propagation", "is", "only", "from", "the", "master", "to", "the", "slave,", "not", "the", "other", "way", "around.", "To", "test", "it,", "you", "can", "insert", "some", "records", "to", "a", "table", "in", "the", "slave", "database,", "and", "check", "if", "it's", "propagated", "to", "the", "master", "instance.", "It", "should", "NOT!", "79", "80", "'''Note:", "When", "you", "restart", "your", "AWS", "instances,", "the", "IP", "addresses", "of", "your", "instances", "could", "change.", "At", "this", "time,", "you", "need", "to", "reset", "the", "master", "address", "on", "the", "slave", "instance", "to", "re-connect", "them.", "However,", "note", "that", "MASTER_LOG_FILE", "and", "MASTER_LOG_POS", "could", "change,", "and", "thus", "you", "need", "to", "check", "the", "master", "status", "again.'''", "81", "{{{", "82", "master-mysql>", "show", "master", "status;", "83", "slave-mysql>", "stop", "slave;", "84", "slave-mysql>", "CHANGE", "MASTER", "TO", "MASTER_HOST='172.2.2.2',", "MASTER_USER='repl',", "MASTER_PASSWORD='slavepassword',", "MASTER_LOG_FILE='mysql-bin.000001',", "MASTER_LOG_POS=337;", "85", "slave-mysql>", "start", "slave;", "86", "slave-mysql>", "show", "slave", "status;", "87", "}}}", "88", "89", "'''Note:", "It", "may", "be", "easy", "for", "you", "to", "create", "new", "AWS", "instances", "using", "an", "image", "of", "an", "existing", "instance.", "To", "do", "so,", "(1)", "select", "an", "existing", "instance", "and", "\"Create", "Image\"", "for", "it;", "and", "(2)", "Select", "the", "generated", "image", "under", "\"IMAGES\"", "->", "\"AMIs\",", "and", "\"Launch\"", "instances", "using", "this", "image.", "If", "you", "use", "this", "approach,", "make", "sure", "to", "read", "this", "[https://connectdevblog.wordpress.com/2014/12/04/mysql-5-6-master-slave-replication/", "page]", "and", "delete", "the", "file", "\"auto.cnf\"", "used", "by", "MySQL", "with", "the", "instance's", "auto-generated", "UUID.'''", "90", "91", "{{{", "92", "shell>", "sudo", "\\rm", "-rf", "/var/lib/mysql/auto.cnf", "93", "}}}", "Powered", "by", "Trac", "1.5.3", "By", "Edgewall", "Software", ".", "Visit", "the", "Trac", "open", "source", "project", "at", "http://trac.edgewall.org/"], "content_hash": "1a2f010acfa0611c97517d09caea97de"}